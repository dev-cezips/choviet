#!/bin/sh
# Git pre-commit hook for Chá»£ Viá»‡t
# ìë™ìœ¼ë¡œ RuboCopì„ ì‹¤í–‰í•˜ì—¬ ì½”ë“œ ìŠ¤íƒ€ì¼ì„ ê²€ì‚¬í•©ë‹ˆë‹¤

echo "ğŸ” Running pre-commit checks..."

# RuboCop ìë™ ìˆ˜ì •
bundle exec rubocop -a
if [ $? -eq 0 ]; then
    # ìˆ˜ì •ëœ íŒŒì¼ë“¤ì„ ìë™ìœ¼ë¡œ stage
    git add -u
    echo "âœ… RuboCop auto-corrections applied"
else
    echo "âŒ RuboCop failed. Please fix errors manually."
    exit 1
fi

# ë‹¤ì‹œ í•œ ë²ˆ ê²€ì‚¬í•˜ì—¬ ë‚¨ì€ ì˜¤ë¥˜ê°€ ìˆëŠ”ì§€ í™•ì¸
bundle exec rubocop
if [ $? -ne 0 ]; then
    echo "âŒ RuboCop still has errors that couldn't be auto-fixed."
    echo "Please fix them manually before committing."
    exit 1
fi

echo "âœ… All pre-commit checks passed!"