#!/bin/bash

# CI í™˜ê²½ì„ ë¡œì»¬ì—ì„œ ì‹œë®¬ë ˆì´ì…˜í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
# "ë¡œì»¬ì—ì„œëŠ” ë˜ëŠ”ë° CIì—ì„œëŠ” ê¹¨ì§"ì„ ë¯¸ë¦¬ ë°©ì§€

echo "ğŸ” Running CI simulation..."
echo ""

# CI í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
export CI=true

# 1. RuboCop ê²€ì‚¬
echo "ğŸ“ Running RuboCop..."
bundle exec rubocop
if [ $? -ne 0 ]; then
    echo "âŒ RuboCop failed"
    exit 1
fi
echo "âœ… RuboCop passed"
echo ""

# 2. í…ŒìŠ¤íŠ¸ ì‹¤í–‰
echo "ğŸ§ª Running tests with CI=true..."
bundle exec rails test
if [ $? -ne 0 ]; then
    echo "âŒ Tests failed"
    exit 1
fi
echo "âœ… All tests passed"
echo ""

echo "ğŸ‰ CI simulation completed successfully!"